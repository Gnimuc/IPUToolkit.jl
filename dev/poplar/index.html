<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Poplar SDK · IPUToolkit.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">IPUToolkit.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">IPUToolkit</a></li><li class="is-active"><a class="tocitem" href>Poplar SDK</a><ul class="internal"><li><a class="tocitem" href="#Convenient-methods"><span>Convenient methods</span></a></li></ul></li><li><a class="tocitem" href="../compiler/">Writing codelets</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Poplar SDK</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Poplar SDK</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/giordano/julia-ipu/blob/main/docs/src/poplar.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Interfacing-the-Poplar-SDK"><a class="docs-heading-anchor" href="#Interfacing-the-Poplar-SDK">Interfacing the Poplar SDK</a><a id="Interfacing-the-Poplar-SDK-1"></a><a class="docs-heading-anchor-permalink" href="#Interfacing-the-Poplar-SDK" title="Permalink"></a></h1><p>A quick example of use of the Poplar SDK functionalities, available in the <code>IPUToolkit.Poplar</code> submodule:</p><pre><code class="language-julia hljs">julia&gt; using IPUToolkit.Poplar

julia&gt; dm = Poplar.DeviceManager();

julia&gt; Int(Poplar.DeviceManagerGetNumDevices(dm))
129

julia&gt; device = Poplar.get_ipu_device();
[ Info: Trying to attach to device 0...
[ Info: Successfully attached to device 0

julia&gt; Int(Poplar.DeviceGetId(device))
0

julia&gt; Poplar.DeviceDetach(device)</code></pre><p>A couple of basic examples of programs running on the IPU written using the interface to the Poplar SDK are available in the files <a href="https://github.com/giordano/julia-ipu/blob/main/examples/tutorial1.jl"><code>examples/tutorial1.jl</code></a> and <a href="https://github.com/giordano/julia-ipu/blob/main/examples/tutorial2.jl"><code>examples/tutorial2.jl</code></a>.</p><p>We automatically generate the bindings of the Poplar SDK using <a href="https://github.com/JuliaInterop/Clang.jl"><code>Clang.jl</code></a> and <a href="https://github.com/JuliaInterop/CxxWrap.jl"><code>CxxWrap.jl</code></a>. There is not automatic documentation at the moment, but functions can be accessed from the <code>Poplar</code> submodule. Also, the <code>IPUToolkit.Poplar</code> submodule wraps a subset of the functionalities available in the Poplar SDK, do not expect to be able to use all functionalities. Remember that Julia does not use class-based object-oriented programming, class instances will usually be first arguments of the methods you want to use.</p><p>Function naming convention and signature is usually as follows:</p><ul><li>class name in <a href="https://en.wikipedia.org/wiki/Camel_case">CamelCase</a>, followed by method name also in CamelCase.  Note that first letter of method name is always uppercase in this naming convention, even if it is lowercase in the Poplar SDK.  For example, the method <code>getNumDevices</code> of the <code>DeviceManager</code> class can be accessed in the <code>Poplar</code> submodule with <code>Poplar.DeviceManagerGetNumDevices</code>;</li><li>the first argument of the function is the class instance.  For example, to use the Julia function <code>Poplar.DeviceManagerGetNumDevices</code>, you need to pass as first argument an instance of <code>DeviceManager</code>;</li><li>the following arguments are the same as in the method you want to use in the SDK.  For example, the method <code>getNumDevices</code> of the <code>DeviceManager</code> class doesn&#39;t take any argument, so the Julia function <code>Poplar.DeviceManagerGetNumDevices</code> will take an instance of <code>DeviceManager</code> as <em>only</em> argument.</li></ul><h2 id="Convenient-methods"><a class="docs-heading-anchor" href="#Convenient-methods">Convenient methods</a><a id="Convenient-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Convenient-methods" title="Permalink"></a></h2><p>In addition to this, for some functions (e.g. <code>EngineWriteTensor</code>, <code>EngineConnectStream</code>, <code>EngineReadTensor</code>) we provide more user-friendly methods where the last argument can be a Julia&#39;s <code>Array</code>, without having to pass additional arguments for pointers or array size. Furthermore, the custom functions <a href="#IPUToolkit.Poplar.get_ipu_device"><code>Poplar.get_ipu_device</code></a> and <a href="#IPUToolkit.Poplar.get_ipu_devices"><code>Poplar.get_ipu_devices</code></a> can be used to access one more IPU devices, as shown in the example above.</p><p>Another function for which we provide a convenient method is <code>Poplar.GraphAddConstant</code>:</p><pre><code class="language-julia hljs">Poplar.GraphAddConstant(graph, host_array)</code></pre><p>adds the <code>host_array</code> (a plain standard Julia <code>Array</code> living on the host) to <code>graph</code>, automatically inferring from <code>host_array</code> the type and the shape of the tensor in the graph.</p><p>You can slice a tensor with the usual Julia notation <code>tensor[index1:index2]</code>, this corresponds to a call to <a href="https://docs.graphcore.ai/projects/poplar-api/en/latest/poplar/graph/Tensor.html#_CPPv4NK6poplar6Tensor5sliceENSt6size_tENSt6size_tE"><code>Tensor.slice(index1, index2+1)</code></a>.</p><p><a href="#Base.similar-Tuple{IPUToolkit.Poplar.Graph, IPUToolkit.Poplar.TensorAllocated}"><code>similar</code></a> can be used to add to <code>graph</code> a tensor with the same shape and optionally element type as <code>tensor</code>.</p><article class="docstring"><header><a class="docstring-binding" id="Base.similar-Tuple{IPUToolkit.Poplar.Graph, IPUToolkit.Poplar.TensorAllocated}" href="#Base.similar-Tuple{IPUToolkit.Poplar.Graph, IPUToolkit.Poplar.TensorAllocated}"><code>Base.similar</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">similar(
    graph::Poplar.Graph,
    tensor::Poplar.TensorAllocated,
    [type::DataType],
    [debug::String]
) -&gt; Poplar.TensorAllocated</code></pre><p>Adds to <code>graph</code> a variable tensor with the same shape as <code>tensor</code>. If a <code>type</code> (this is a Julia type, like <code>Float32</code> or <code>Int32</code>) argument is not passed, the same element type as <code>tensor</code> will be automatically used. An optional <code>debug</code> context can also be passed, as a <code>String</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/giordano/julia-ipu/blob/329d93830fb168663eff7bb0802df323e878e3cf/src/poplar.jl#L75-L86">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IPUToolkit.Poplar.get_ipu_device" href="#IPUToolkit.Poplar.get_ipu_device"><code>IPUToolkit.Poplar.get_ipu_device</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_ipu_device(hint::Union{AbstractVector{&lt;:Integer},Integer}=0)</code></pre><p>Similar to <a href="#IPUToolkit.Poplar.get_ipu_devices"><code>get_ipu_devices</code></a>, but request exactly one IPU device.  If it can attach to a device, return that pointer only (not in a vector, like <code>get_ipu_devices</code>), otherwise return <code>nothing</code>.  You can release the device with <code>Poplar.DeviceDetach(device)</code>.</p><p>The optional argument <code>hint</code> suggests to which device IDs to try and attach.  It can have different types:</p><ul><li>if of type <code>Integer</code>, try to attach to one device, starting from the one with index <code>hint</code>. The default is <code>hint=0</code>;</li><li>if of type <code>AbstractVector</code>, try to attach to a device from that list of IDs.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/giordano/julia-ipu/blob/329d93830fb168663eff7bb0802df323e878e3cf/src/poplar.jl#L147-L160">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="IPUToolkit.Poplar.get_ipu_devices" href="#IPUToolkit.Poplar.get_ipu_devices"><code>IPUToolkit.Poplar.get_ipu_devices</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">get_ipu_devices(n::Int, hint::Union{AbstractVector{&lt;:Integer},Integer}=0)</code></pre><p>Try to attach to <code>n</code> IPU devices, returns a vector of the pointers to the devices successfully attached to.  You can release them with <code>Poplar.DeviceDetach</code> (note that this function takes a single pointer as input, so you have to use broadcasting <code>Poplar.DeviceDetach.(devices)</code> to release a vector of pointers).</p><p>The second optional argument <code>hint</code> suggests to which device IDs to try and attach.  It can have different types:</p><ul><li>if of type <code>Integer</code>, try to attach to <code>n</code> devices, starting from the one with index <code>hint</code>.  The default is <code>hint=0</code>;</li><li>if of type <code>AbstractVector</code>, try to attach to <code>n</code> devices from that list of IDs.</li></ul><p>See <a href="#IPUToolkit.Poplar.get_ipu_device"><code>get_ipu_device</code></a> for requesting exactly one IPU device.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/giordano/julia-ipu/blob/329d93830fb168663eff7bb0802df323e878e3cf/src/poplar.jl#L97-L114">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« IPUToolkit</a><a class="docs-footer-nextpage" href="../compiler/">Writing codelets »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 4 June 2023 01:49">Sunday 4 June 2023</span>. Using Julia version 1.9.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
